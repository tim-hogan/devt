var ThreeD={def:function(t){return void 0!==t},Vector3D:function(t,a,i){this.x=t,this.y=a,this.z=i,this.add=function(t){return vout=new ThreeD.Vector3D(this.x+t.x,this.y+t.y,this.z+t.z)},this.subtract=function(t){return vout=new ThreeD.Vector3D(this.x-t.x,this.y-t.y,this.z-t.z)},this.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},this.lenthto=function(t){var a=this.x-t.x,i=this.y-t.y,s=this.z-t.z;return Math.sqrt(a*a+i*i+s*s)},this.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},this.cross=function(t){var a=new ThreeD.Vector3D(0,0,0);return a.x=this.y*t.z-this.z*t.y,a.y=this.z*t.x-this.x*t.z,a.z=this.x*t.y-this.y*t.x,a},this.normalize=function(){var t=this.length();0<t&&(this.x=this.x/t,this.y=this.y/t,this.z=this.z/t)},this.zzero=function(t){var a=(1-this.z)/(t.z-this.z);return vout.x=this.x+(t.x-this.x)*a,vout.y=this.y+(t.y-this.y)*a,vout.z=1,vout},this.applymatrix=function(t){var a=new ThreeD.Vector3D(0,0,0);return a.x=this.x*t.data[0]+this.y*t.data[4]+this.z*t.data[8]+t.data[12],a.y=this.x*t.data[1]+this.y*t.data[5]+this.z*t.data[9]+t.data[13],a.z=this.x*t.data[2]+this.y*t.data[6]+this.z*t.data[10]+t.data[14],a}},TwoVector3D:function(t,a){this.v1=t,this.v2=a},Matrix3D:function(){this.data=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.setView=function(t,a,i){var s=a.subtract(t);s.normalize();var h=i.cross(s);h.normalize();var d=s.cross(h);d.normalize(),this.data[0]=h.x,this.data[1]=d.x,this.data[2]=s.x,this.data[3]=0,this.data[4]=h.y,this.data[5]=d.y,this.data[6]=s.y,this.data[7]=0,this.data[8]=h.z,this.data[9]=d.z,this.data[10]=s.z,this.data[11]=0,this.data[12]=-h.dot(t),this.data[13]=-d.dot(t),this.data[14]=-s.dot(t),this.data[15]=1},this.inverse=function(){var t=new ThreeD.Matrix3D;t.data[0]=this.data[5]*this.data[10]*this.data[15]-this.data[5]*this.data[11]*this.data[14]-this.data[9]*this.data[6]*this.data[15]+this.data[9]*this.data[7]*this.data[14]+this.data[13]*this.data[6]*this.data[11]-this.data[13]*this.data[7]*this.data[10],t.data[4]=-this.data[4]*this.data[10]*this.data[15]+this.data[4]*this.data[11]*this.data[14]+this.data[8]*this.data[6]*this.data[15]-this.data[8]*this.data[7]*this.data[14]-this.data[12]*this.data[6]*this.data[11]+this.data[12]*this.data[7]*this.data[10],t.data[8]=this.data[4]*this.data[9]*this.data[15]-this.data[4]*this.data[11]*this.data[13]-this.data[8]*this.data[5]*this.data[15]+this.data[8]*this.data[7]*this.data[13]+this.data[12]*this.data[5]*this.data[11]-this.data[12]*this.data[7]*this.data[9],t.data[12]=-this.data[4]*this.data[9]*this.data[14]+this.data[4]*this.data[10]*this.data[13]+this.data[8]*this.data[5]*this.data[14]-this.data[8]*this.data[6]*this.data[13]-this.data[12]*this.data[5]*this.data[10]+this.data[12]*this.data[6]*this.data[9],t.data[1]=-this.data[1]*this.data[10]*this.data[15]+this.data[1]*this.data[11]*this.data[14]+this.data[9]*this.data[2]*this.data[15]-this.data[9]*this.data[3]*this.data[14]-this.data[13]*this.data[2]*this.data[11]+this.data[13]*this.data[3]*this.data[10],t.data[5]=this.data[0]*this.data[10]*this.data[15]-this.data[0]*this.data[11]*this.data[14]-this.data[8]*this.data[2]*this.data[15]+this.data[8]*this.data[3]*this.data[14]+this.data[12]*this.data[2]*this.data[11]-this.data[12]*this.data[3]*this.data[10],t.data[9]=-this.data[0]*this.data[9]*this.data[15]+this.data[0]*this.data[11]*this.data[13]+this.data[8]*this.data[1]*this.data[15]-this.data[8]*this.data[3]*this.data[13]-this.data[12]*this.data[1]*this.data[11]+this.data[12]*this.data[3]*this.data[9],t.data[13]=this.data[0]*this.data[9]*this.data[14]-this.data[0]*this.data[10]*this.data[13]-this.data[8]*this.data[1]*this.data[14]+this.data[8]*this.data[2]*this.data[13]+this.data[12]*this.data[1]*this.data[10]-this.data[12]*this.data[2]*this.data[9],t.data[2]=this.data[1]*this.data[6]*this.data[15]-this.data[1]*this.data[7]*this.data[14]-this.data[5]*this.data[2]*this.data[15]+this.data[5]*this.data[3]*this.data[14]+this.data[13]*this.data[2]*this.data[7]-this.data[13]*this.data[3]*this.data[6],t.data[6]=-this.data[0]*this.data[6]*this.data[15]+this.data[0]*this.data[7]*this.data[14]+this.data[4]*this.data[2]*this.data[15]-this.data[4]*this.data[3]*this.data[14]-this.data[12]*this.data[2]*this.data[7]+this.data[12]*this.data[3]*this.data[6],t.data[10]=this.data[0]*this.data[5]*this.data[15]-this.data[0]*this.data[7]*this.data[13]-this.data[4]*this.data[1]*this.data[15]+this.data[4]*this.data[3]*this.data[13]+this.data[12]*this.data[1]*this.data[7]-this.data[12]*this.data[3]*this.data[5],t.data[14]=-this.data[0]*this.data[5]*this.data[14]+this.data[0]*this.data[6]*this.data[13]+this.data[4]*this.data[1]*this.data[14]-this.data[4]*this.data[2]*this.data[13]-this.data[12]*this.data[1]*this.data[6]+this.data[12]*this.data[2]*this.data[5],t.data[3]=-this.data[1]*this.data[6]*this.data[11]+this.data[1]*this.data[7]*this.data[10]+this.data[5]*this.data[2]*this.data[11]-this.data[5]*this.data[3]*this.data[10]-this.data[9]*this.data[2]*this.data[7]+this.data[9]*this.data[3]*this.data[6],t.data[7]=this.data[0]*this.data[6]*this.data[11]-this.data[0]*this.data[7]*this.data[10]-this.data[4]*this.data[2]*this.data[11]+this.data[4]*this.data[3]*this.data[10]+this.data[8]*this.data[2]*this.data[7]-this.data[8]*this.data[3]*this.data[6],t.data[11]=-this.data[0]*this.data[5]*this.data[11]+this.data[0]*this.data[7]*this.data[9]+this.data[4]*this.data[1]*this.data[11]-this.data[4]*this.data[3]*this.data[9]-this.data[8]*this.data[1]*this.data[7]+this.data[8]*this.data[3]*this.data[5],t.data[15]=this.data[0]*this.data[5]*this.data[10]-this.data[0]*this.data[6]*this.data[9]-this.data[4]*this.data[1]*this.data[10]+this.data[4]*this.data[2]*this.data[9]+this.data[8]*this.data[1]*this.data[6]-this.data[8]*this.data[2]*this.data[5];var a=this.data[0]*t.data[0]+this.data[1]*t.data[4]+this.data[2]*t.data[8]+this.data[3]*t.data[12];if(0==a)return!1;for(a=1/a,i=0;i<16;i++)t.data[i]=t.data[i]*a;return t},this.transformarray=function(t){for(var a=0;a<t.length;a++)t[a]=t[a].applymatrix(this)}},Screen:function(t,a,i){this.scale=t,this.bottomleftX=a,this.bottomleftY=i,this.RealToScreen=function(t,a){var i;return i=ThreeD.def(a)?t.applymatrix(a):t,vout=new ThreeD.Vector3D(0,0,0),ThreeD.def(i)?(vout.x=i.x/i.z*this.scale,vout.y=i.y/i.z*this.scale,vout.x=vout.x-this.bottomleftX,vout.y=vout.y-this.bottomleftY,vout.z=i.z):console.log("Bug"),vout},this.RealToScreenLine=function(t,a){var i,s,h;if(vs=new ThreeD.Vector3D(0,0,0),vp=new ThreeD.Vector3D(0,0,0),t.z<0||a.z<0){if(t.z<0&&a.z<0)return null;s=a.x==t.x?a.x:(i=(a.z-t.z)/(a.x-t.x),(-t.z+i*t.x)/i),h=a.y==t.y?a.y:(i=(a.z-t.z)/(a.y-t.y),(-t.z+i*t.y)/i),t.z<0?(vs.x=s*this.scale-this.bottomleftX,vs.y=h*this.scale-this.bottomleftY,vs.z=t.z,vp.x=a.x/a.z*this.scale-this.bottomleftX,vp.y=a.y/a.z*this.scale-this.bottomleftY,vp.z=a.z):(vp.x=s*this.scale-this.bottomleftX,vp.y=h*this.scale-this.bottomleftY,vp.z=a.z,vs.x=t.x/t.z*this.scale-this.bottomleftX,vs.y=t.y/t.z*this.scale-this.bottomleftY,vs.z=t.z)}else vs.x=t.x/t.z*this.scale-this.bottomleftX,vs.y=t.y/t.z*this.scale-this.bottomleftY,vp.x=a.x/a.z*this.scale-this.bottomleftX,vp.y=a.y/a.z*this.scale-this.bottomleftY;return new ThreeD.TwoVector3D(vs,vp)}}};